<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Buscar actividades por VIN</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{ --accent:#0d6efd; --muted:#6c757d; --border:#e9ecef }
    body{font-family:Inter,system-ui,-apple-system,'Segoe UI',Roboto,Arial;background:#fff;color:#111}
    .hero{padding:12px 8px;margin-bottom:14px;border-bottom:1px solid var(--border)}
    h4{font-weight:600;margin:0}
    .contenedor-actividad{border:1px solid var(--border);border-radius:6px;margin-bottom:10px;background:#fff}
    .card-header.custom{background:transparent;color:#111;padding:10px 12px;font-weight:700;border-bottom:1px solid var(--border)}
    .panel-body{padding:10px}
    .item-row{display:flex;align-items:center;justify-content:space-between;padding:8px 6px;border-bottom:1px solid var(--border)}
    .item-meta{flex:1;margin-right:8px}
    .item-row:last-child{border-bottom:none}
    .selected{background:#f1fbf3}
    .small-muted{color:var(--muted);font-size:0.9rem}
    .badge-count{background:#f1f3f5;color:#111;border-radius:999px;padding:4px 8px;font-weight:600;border:1px solid var(--border)}
    .results-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
    .no-results{text-align:center;color:var(--muted);padding:18px}
    /* minimal search controls */
    .search-controls label{display:none}
    .input-group-append .btn{border-top-left-radius:0;border-bottom-left-radius:0}
    @media(max-width:767px){.col-md-8,.col-md-4{width:100%}}
  </style>
</head>
<body class="p-3">
  <div class="container">
    <div class="hero row mb-3 align-items-center">
      <div class="col-md-8">
        <h4><i class="fa-solid fa-car-side"></i> Buscar actividades por VIN</h4>
        <p class="small-muted mb-0">Introduce una fracción del VIN y pulsa Buscar. Autenticación desde el plugin si está disponible.</p>
      </div>
      <div class="col-md-4 text-right">
        <small class="text-muted">Repo: <a href="https://github.com/kaltalbert87/pugin-searchWoActive" target="_blank">pugin-searchWoActive</a></small>
      </div>
    </div>

    <div class="row align-items-end mb-3 search-controls">
      <div class="col-md-8">
        <label for="vinInput">VIN (o fragmento)</label>
        <div class="input-group">
          <input id="vinInput" class="form-control form-control-lg" placeholder="Ej: 72894 o 3N1CK3CD" />
          <div class="input-group-append">
            <button id="searchBtn" class="btn btn-primary"><i class="fa-solid fa-magnifying-glass"></i> Buscar</button>
          </div>
        </div>
      </div>
      <div class="col-md-4 text-right">
        <div id="spinnerArea" style="display:none;">
          <div class="spinner-border text-primary custom" role="status"><span class="sr-only">Loading...</span></div>
        </div>
      </div>
    </div>

    <div class="row mb-2">
      <div class="col-12">
        <div id="statusArea" class="mb-2"></div>
      </div>
    </div>

    <div class="row">
      <div class="col-12">
        <div class="results-header" id="resultsHeader" style="display:none;">
          <div id="resultsSummary"></div>
          <div id="resultsActions"></div>
        </div>
        <div id="results"></div>
        <div id="noResults" class="no-results" style="display:none;">No se encontraron actividades. Intenta otra fracción de VIN.</div>
      </div>
    </div>

    <div class="row mt-3">
      <div class="col-12">
        <div id="selectionArea" class="p-3 border rounded" style="display:none;">
          <h5>Registro seleccionado ✅</h5>
          <div id="selectedDetails"></div>
          <div class="mt-2">
            <button id="confirmBtn" class="btn btn-success">Confirmar selección</button>
            <button id="clearSelection" class="btn btn-outline-secondary">Limpiar</button>
          </div>
        </div>
      </div>
    </div>

    <footer class="mt-4 small text-muted">Plugin ligero para Oracle Field Service — interfaz de búsqueda por VIN</footer>
  </div>

  <script src="search.js"></script>
</body>
</html>
